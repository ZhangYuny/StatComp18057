devtools::build_vignettes()
devtools::document()
devtools::build_vignettes()
devtools::document()
n <- 1000; r <- 4; beta <- 2
lambda <- rgamma(n, r, beta)
y <- rexp(n, lambda)
hist(y,freq=F,main="Histogram of mixture")
y <- seq(1, 20, 0.01)
sp=spline(y,y^2/(sqrt(2*pi))*exp(-y^2/2),n=1000)
sp1=spline(y,(sqrt(2*pi))*exp(-y^2/2),n=1000)
sp2=spline(y,(1/(2*sqrt(2)))*(2/(2+y^2))^{3/2},n=1000)# t-distribution df=2
sp3=spline(y,(2/(sqrt(2)*pi))*(3/(3+y^2))^{2},n=1000)#t-distribution df=3
sp4=spline(y,(3/8)*(4/(4+y^2))^{5/2},n=1000)#t-distribution df=4
plot(sp,type="l",col="red",lwd=2)
lines(sp1,type="l",col="green",lwd=2)
lines(sp2,type="l",col="yellow",lwd=2)
lines(sp3,type="l",col="blue",lwd=2)
lines(sp4,type="l",col="black",lwd=2)
legend("topright",legend=c("g(x)","f1(x)","f2(x)-df=2","f2(x)-df=3","f2(x)-df=4"),col=c("red","green","blue","black"),lwd=2,lty=c(1,1,1,1))
qqplot(y,rbeta(n,3,2),xlab='Accpetance-rejection',ylab='rbeta')
abline(0,1,col='blue',lwd=2)
set.seed(123)
n <- 1000;j<-k<-0;y <- numeric(n)
while (k < n) {
u <- runif(1)
j <- j + 1
x <- runif(1) #random variate from g
if (4*x^2*(1-x) > u) {
#we accept x
k <- k + 1
y[k] <- x
}
}
j    # #(experiments) for n random numbers
n <- 1000; r <- 4; beta <- 2
lambda <- rgamma(n, r, beta)
y <- rexp(n, lambda)
hist(y,freq=F,main="Histogram of mixture")
y <- seq(1, 20, 0.01)
sp=spline(y,y^2/(sqrt(2*pi))*exp(-y^2/2),n=1000)
sp1=spline(y,(sqrt(2*pi))*exp(-y^2/2),n=1000)
sp2=spline(y,(1/(2*sqrt(2)))*(2/(2+y^2))^{3/2},n=1000)# t-distribution df=2
sp3=spline(y,(2/(sqrt(2)*pi))*(3/(3+y^2))^{2},n=1000)#t-distribution df=3
sp4=spline(y,(3/8)*(4/(4+y^2))^{5/2},n=1000)#t-distribution df=4
plot(sp,type="l",col="red",lwd=2)
lines(sp1,type="l",col="green",lwd=2)
lines(sp2,type="l",col="yellow",lwd=2)
lines(sp3,type="l",col="blue",lwd=2)
lines(sp4,type="l",col="black",lwd=2)
legend("topright",legend=c("g(x)","f1(x)","f2(x)-df=2","f2(x)-df=3","f2(x)-df=4"),col=c("red","green","blue","black"),lwd=2,lty=c(1,1,1,1))
devtools::build_vignettes()
devtools::document()
devtools::build_vignettes()
data("InsectSprays")
aov.spray <- aov(sqrt(count) ~ spray, data = InsectSprays)
aov.spray
summary(aov.spray)
par(mfcol = c(2, 2))
plot(aov.spray)
termplot(aov.spray, se=TRUE, rug=TRUE)
#A function is defined to calculate the Cramer-von Mises statistics of two sample univariate data.
W2<-function(x,y,n,m){
n <- length(x)
m <- length(y)
Fn<-ecdf(x)
Gm<-ecdf(y)
t<-(m*n/(m+n)^2)*(sum((Fn(x)-Gm(x))^2)+sum((Fn(y)-Gm(y))^2))
return(t)
}
#Retrieving raw data
attach(chickwts)  #data
x <- sort(as.vector(weight[feed == "soybean"]))
y <- sort(as.vector(weight[feed == "linseed"]))
detach(chickwts)
#Setting function parameters
R <- 999     #number of replicates
z <- c(x, y) #pooled sample
K <- 1:26    #sizes of  pooled sampl
W <- numeric(R) #storage for replicates
W20<-W2(x,y) # Cramer-von Mises statistics calculated from original samples
for (i in 1:R) {
##generate indices k for the first sample
k <- sample(K, size = 14, replace = FALSE)
x1 <- z[k]
y1 <- z[-k] #complement of x1
W[i] <- W2(x1,y1)
} # Cramer-von Mises statistics calculated from permutation samples
p <- mean(c(W20, W) >= W20) #p-vaule
print(p)
devtools::install_github("zhaoynan/StatComp18038")
devtools::document()
devtools::document()
devtools::document()
devtools::build_vignettes()
devtools::document()
devtools::build_vignettes()
devtools::document()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::document()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::document()
